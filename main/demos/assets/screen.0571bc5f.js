import{f3 as V,et as c,eu as b,ew as i,eB as d,ez as a,eJ as u,eA as r,eD as T,fk as P,eL as F,eM as U,eY as L,eG as z,eH as O,fL as B,eC as j,eE as k,eX as M,eO as m,ey as g,eF as R,fr as G,fM as q,fN as Y,e$ as _,eI as A,fa as $,fd as W,fB as f,eS as H,ev as h,ex as v,eV as C}from"./main.a2193d12.js";class J{layerSource=null;url="";fileData=null;typeSelection="";layerInfo={config:null,configOptions:[]};step=s.UPLOAD}var s=(e=>(e[e.UPLOAD=0]="UPLOAD",e[e.FORMAT=1]="FORMAT",e[e.CONFIGURE=2]="CONFIGURE",e))(s||{});const K={},Z={goToStep:(e,t)=>{switch(e.state.step){case s.UPLOAD:t===s.UPLOAD?e.commit("SET_URL",""):t===s.FORMAT&&e.commit("SET_STEP",s.FORMAT);break;case s.FORMAT:t===s.UPLOAD?(e.state.fileData&&(e.commit("SET_URL",""),e.commit("SET_FILE_DATA",null)),e.commit("SET_TYPE_SELECTION",""),e.commit("SET_STEP",s.UPLOAD)):t===s.CONFIGURE&&e.commit("SET_STEP",s.CONFIGURE);break;case s.CONFIGURE:t===s.UPLOAD?(e.commit("SET_URL",""),e.commit("SET_TYPE_SELECTION",""),e.commit("SET_FILE_DATA",null),e.commit("SET_LAYER_INFO",{config:null,configOptions:[]}),e.commit("SET_STEP",s.UPLOAD)):t===s.FORMAT&&(e.commit("SET_LAYER_INFO",{config:null,configOptions:[]}),e.commit("SET_STEP",s.FORMAT));break}}},X={};var y=(e=>(e.layerSource="wizard/layerSource",e.url="wizard/url",e.typeSelection="wizard/typeSelection",e.fileData="wizard/fileData",e.layerInfo="wizard/layerInfo",e.step="wizard/step",e.goToStep="wizard/goToStep",e))(y||{});function lt(){const e=new J;return{namespaced:!0,state:e,getters:{...K},actions:{...Z,...V.actions(e)},mutations:{...X,...V.mutations(e)}}}const Q=c({name:"WizardFormFooterV",props:{disabled:{type:Boolean,default:!0}}}),x={class:"flex justify-end mb-20"},ee=["disabled"];function te(e,t,n,p,S,w){return i(),d("div",x,[a("button",{class:"hover:bg-gray-200 text-gray-600 font-bold py-8 px-16 m-2",type:"button",onClick:t[0]||(t[0]=l=>e.$emit("cancel"))},u(e.$t("wizard.step.cancel")),1),a("button",{class:"bg-blue-500 hover:bg-blue-700 text-white font-bold py-8 px-16 m-2 disabled:bg-gray-200 disabled:cursor-default disabled:text-gray-400",type:"button",disabled:e.disabled,onClick:t[1]||(t[1]=l=>e.$emit("submit"))},u(e.$t("wizard.step.continue")),9,ee)])}var le=b(Q,[["render",te],["__file","/home/runner/work/ramp4-pcar4/ramp4-pcar4/src/fixtures/wizard/form-footer.vue"]]);const ae=c({name:"WizardInputV",props:{defaultOption:{type:Boolean,default:!1},formatError:{type:Boolean,default:!1},help:{type:[String,Boolean],default:!1},label:{type:[String,Boolean],default:!1},modelValue:{type:[String,Array],default:""},name:{type:[String,Boolean],default:!1},options:{type:Array,default:[]},size:{type:[Number,Boolean],default:!1},multiple:{type:Boolean,default:!1},type:{type:String,default:"text"},url:{type:[String,Boolean],default:!1},validation:{type:Boolean,default:!1},validationMessages:{type:Object}},created(){if(this.defaultOption&&this.modelValue===""&&this.options.length){let e=this.options[0].value;if(this.name==="latField"){const t=new RegExp(/^(y|lat.*)$/i);e=this.options.find(p=>t.test(p.label))?.value||e}else if(this.name==="longField"){const t=new RegExp(/^(x|long.*)$/i);e=this.options.find(p=>t.test(p.label))?.value||e}this.$emit("update:modelValue",e)}},data(){return{valid:!1,urlError:!1,layerEntriesError:!1,selected:[]}},methods:{validUrl(e){let t;try{t=new URL(e)}catch{return this.valid=!1,!1}t.protocol==="http:"||t.protocol==="https:"?this.valid=!0:this.valid=!1},checkMultiSelectError(e){e&&e.length>0?this.layerEntriesError=!1:this.layerEntriesError=!0}}}),ie=e=>(z("data-v-123e95fc"),e=e(),O(),e),oe={class:"input-wrapper mb-12"},se={key:0},re={class:"text-base font-bold"},ne={class:"relative py-8 mb-0.5 h-75","data-type":"file"},de=ie(()=>a("div",{class:"upload-mask absolute inset-0 flex border-dashed border-2 border-gray-400 pointer-events-none justify-center"},[a("svg",{class:"w-30 h-30 m-auto",fill:"#a8a8a8",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 58 58"},[a("path",{d:"M29,58A29,29,0,1,0,0,29,29,29,0,0,0,29,58ZM29,4A25,25,0,1,1,4,29,25,25,0,0,1,29,4Z"}),a("polygon",{points:"27 22 27 44.4 31 44.4 31 22 41.7 31.1 44.3 28.1 29 15 13.7 28.1 16.3 31.1 27 22"})])],-1)),ue={class:"text-gray-400 text-xs mb-1"},pe={key:1},fe={class:"text-base font-bold"},me={class:"mb-0.5","data-type":"url"},ye=["value"],ve={key:0,class:"text-red-900 text-xs"},ge={key:2},he={class:"text-base font-bold"},ce={class:"relative mb-0.5","data-type":"select"},be={key:0},Se=["value"],we=["value"],$e={class:"text-gray-400 text-xs mb-1"},Ee={key:0,class:"text-red-900 text-xs"},Ie={key:1},Te=["size","value"],Fe=["value"],ze={key:0,class:"text-red-900 text-xs"},Oe={key:3},Ve={class:"text-base font-bold"},Ue={class:"relative mb-0.5"},ke=["value"],Ae={key:0,class:"text-red-900 text-xs"};function Ce(e,t,n,p,S,w){return i(),d("div",oe,[e.type==="file"?(i(),d("div",se,[a("label",re,u(e.label),1),a("div",ne,[a("input",{class:"absolute w-full opacity-0 inset-0 cursor-pointer",type:"file",name:"file",accept:".geojson,.json,.csv,.zip",onInput:t[0]||(t[0]=l=>{e.$emit("upload",l.target.files[0]),l.target.value=null})},null,32),de]),a("div",ue,u(e.help),1)])):e.type==="url"?(i(),d("div",pe,[a("label",fe,u(e.label),1),a("div",me,[a("input",{class:"text-sm w-full border-solid border-gray-300 mb-5 leading-5 focus:border-green-500",type:"url",name:"url",value:e.modelValue,onChange:t[1]||(t[1]=l=>e.valid?e.urlError=!1:e.urlError=!0),onInput:t[2]||(t[2]=l=>{e.validUrl(l.target.value),e.$emit("link",l.target.value,e.valid),e.urlError=!1})},null,40,ye)]),e.urlError?(i(),d("div",ve,u(e.modelValue?e.validationMessages.invalid:e.validationMessages.required),1)):r("v-if",!0)])):e.type==="select"?(i(),d("div",ge,[a("label",he,u(e.label),1),a("div",ce,[e.multiple?(i(),d("div",be,[T(a("select",{class:"block border-solid border-gray-300 w-full p-3 overflow-y-auto",multiple:"",value:e.modelValue,"onUpdate:modelValue":t[3]||(t[3]=l=>e.selected=l),onChange:t[4]||(t[4]=l=>{e.$emit("select",e.selected),e.checkMultiSelectError(e.selected)})},[(i(!0),d(F,null,U(e.options,l=>(i(),d("option",{class:"p-6",key:l,value:l.value},u(l.label),9,we))),128))],40,Se),[[P,e.selected]]),a("div",$e,u(e.help),1),e.validation&&e.layerEntriesError?(i(),d("div",Ee,u(e.validationMessages.required),1)):r("v-if",!0)])):(i(),d("div",Ie,[a("select",{class:L(["block border-solid border-gray-300 w-full p-3 overflow-y-auto",e.size&&"configure-select"]),size:e.size?e.size:null,value:e.modelValue,onInput:t[5]||(t[5]=l=>e.size?e.$emit("select",l.target.value):e.$emit("update:modelValue",l.target.value))},[(i(!0),d(F,null,U(e.options,l=>(i(),d("option",{class:"p-6",key:l,value:l.value},u(l.label),9,Fe))),128))],42,Te),e.validation&&e.formatError?(i(),d("div",ze,u(e.validationMessages.invalid),1)):r("v-if",!0)]))])])):(i(),d("div",Oe,[a("label",Ve,u(e.label),1),a("div",Ue,[a("input",{class:"border-solid border-gray-300 p-3 w-full",type:"text",value:e.modelValue,onChange:t[6]||(t[6]=l=>e.$emit("text",l.target.value))},null,40,ke)]),e.validation&&!e.modelValue?(i(),d("div",Ae,u(e.validationMessages.required),1)):r("v-if",!0)]))])}var Le=b(ae,[["render",Ce],["__scopeId","data-v-123e95fc"],["__file","/home/runner/work/ramp4-pcar4/ramp4-pcar4/src/fixtures/wizard/form-input.vue"]]);const Me=c({name:"WizardStepperItemV",props:{title:{type:String,required:!0},summary:{type:String}},data(){return{index:-1}},setup(){return{stepper:B("stepper")}},mounted(){this.index=this.stepper.numSteps++},methods:{done(){return this.stepper.activeIndex>this.index},active(){return this.stepper.activeIndex===this.index}}}),Re=e=>(z("data-v-37be0d4a"),e=e(),O(),e),Ne={class:"step relative flex flex-col px-12 overflow-y-hidden"},De={class:"stepper-header flex pb-24"},Pe=Re(()=>a("div",{class:"flex-none stepper-check w-24 h-24 text-gray-400"},[a("svg",{xmlns:"http://www.w3.org/2000/svg",height:"100%",width:"100%",preserveAspectRatio:"xMidYMid meet",viewBox:"0 0 24 24",focusable:"false"},[a("g",{id:"check_circle"},[a("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"})])])],-1)),Be={class:"flex flex-col overflow-hidden"},je={class:"pl-12 flex items-center text-md"},Ge={class:"pl-12 text-xs transition-opacity duration-1000 ease-out"},qe={class:"pl-36"};function Ye(e,t,n,p,S,w){const l=j("truncate");return i(),d("div",Ne,[a("div",De,[r(" step number "),e.done()?(i(),d(F,{key:1},[r(" show checkmark if done "),Pe],2112)):(i(),d("div",{key:0,class:L(["w-24 h-24 bg-gray-400 rounded-full flex justify-center items-center text-white text-xs font-semibold",{"bg-blue-500":e.active}])},u(e.index+1),3)),a("div",Be,[r(" step title "),a("div",je,u(e.title),1),r(" step summary "),T((i(),d("div",Ge,[M(u(e.summary),1)])),[[k,!e.active()],[l]])])]),m(G,{name:"step",mode:"out-in"},{default:g(()=>[T(a("div",qe,[r(" step content "),R(e.$slots,"default",{},void 0,!0)],512),[[k,e.active()]])]),_:3})])}var _e=b(Me,[["render",Ye],["__scopeId","data-v-37be0d4a"],["__file","/home/runner/work/ramp4-pcar4/ramp4-pcar4/src/fixtures/wizard/stepper-item.vue"]]);const We=c({name:"WizardStepperV",props:{activeStep:{type:Number,default:0}},data(){return{watchers:[]}},setup(e){const t=q({activeIndex:e.activeStep,numSteps:0});return Y("stepper",t),{stepper:t}},created(){this.watchers.push(this.$watch("activeStep",()=>{this.stepper.activeIndex=this.activeStep}))},beforeUnmount(){this.watchers.forEach(e=>e())}}),He={class:"py-12"};function Je(e,t,n,p,S,w){return i(),d("div",He,[R(e.$slots,"default")])}var Ke=b(We,[["render",Je],["__file","/home/runner/work/ramp4-pcar4/ramp4-pcar4/src/fixtures/wizard/stepper.vue"]]);const Ze=c({name:"WizardScreenV",props:{panel:_},components:{"wizard-form-footer":le,"wizard-input":Le,"stepper-item":_e,stepper:Ke},data(){return{layerSource:A(y.layerSource),step:A(y.step),url:$(y.url),fileData:$(y.fileData),typeSelection:$(y.typeSelection),layerInfo:$(y.layerInfo),goToStep:W(y.goToStep),formulateFile:{},formatError:!1,goNext:!1,finishStep:!1,serviceTypeOptions:[{value:f.FEATURE,label:this.$t("wizard.layerType.esriFeature")},{value:f.MAPIMAGE,label:this.$t("wizard.layerType.esriMapImage")},{value:f.TILE,label:this.$t("wizard.layerType.esriTile")},{value:f.IMAGERY,label:this.$t("wizard.layerType.esriImagery")},{value:f.WMS,label:this.$t("wizard.layerType.ogcWms")},{value:f.WFS,label:this.$t("wizard.layerType.ogcWfs")}],fileTypeOptions:[{value:f.GEOJSON,label:this.$t("wizard.fileType.geojson")},{value:f.SHAPEFILE,label:this.$t("wizard.fileType.shapefile")},{value:f.CSV,label:this.$t("wizard.fileType.csv")}]}},errorCaptured(e,t,n){return(this.step===s.FORMAT||this.step===s.CONFIGURE)&&(this.formatError=!0,this.goToStep(s.FORMAT)),!1},methods:{async uploadFile(e,t){const n=new FileReader;n.onerror=()=>{this.formulateFile={}},n.onload=p=>{this.fileData=n.result,this.url=e.name,this.onUploadContinue(p)},n.readAsArrayBuffer(e)},onUploadContinue(e){e?.preventDefault(),this.fileData&&setTimeout(()=>{this.formulateFile={}},500),this.typeSelection=this.layerSource.guessFormatFromURL(this.url),this.goToStep(s.FORMAT)},async onSelectContinue(){this.layerInfo=this.isFileLayer()?await this.layerSource.fetchFileInfo(this.url,this.typeSelection,this.fileData):await this.layerSource.fetchServiceInfo(this.url,this.typeSelection);const e=this.typeSelection===f.FEATURE&&!(this.layerInfo&&this.layerInfo.fields);if(!this.layerInfo||e){this.formatError=!0,this.layerInfo={config:null,configOptions:[]};return}this.goToStep(s.CONFIGURE),this.layerInfo.configOptions.includes("layerEntries")?this.finishStep=!1:this.finishStep=!0},async onConfigureContinue(e){const t=Object.assign(this.layerInfo.config,e),n=this.$iApi.geo.layer.createLayer(t);await n.initiate(),n.userAdded=!0,this.$iApi.event.emit(H.USER_LAYER_ADDED,n),this.$iApi.geo.map.addLayer(n),this.goNext=!1,this.goToStep(s.UPLOAD)},fieldOptions(){return this.layerInfo.fields.map(e=>({value:e.name,label:e.alias||e.name}))},latLonOptions(e){},sublayerOptions(){return this.layerInfo.layers.map((e,t)=>({label:`${e.indent}${e.name}`,value:this.typeSelection===f.MAPIMAGE?{index:e.id,state:{opacity:1,visibility:!0}}:{id:e.id},id:`${e.indent}${e.name}-${t}`}))},isFileLayer(){return this.fileData||this.url.match(/\.(zip|csv|json|geojson)$/)},setError(e,t,n){this.$formulate.handle({inputErrors:{[t]:[n]},formErrors:[]},e)},updateFile(e){this.formulateFile=e,this.uploadFile(e)},updateUrl(e,t){this.url=e.trim(),t?this.goNext=!0:this.goNext=!1},updateTypeSelection(e){this.typeSelection=e,this.formatError=!1},updateLayerName(e){this.layerInfo.config.name=e;const t=this.layerInfo.config.layerEntries;(t?e&&t.length>0:e)?this.finishStep=!0:this.finishStep=!1},updateLayerEntries(e){this.layerInfo.config.layerEntries=e,e.length>0&&this.layerInfo.config.name?this.finishStep=!0:this.finishStep=!1}}}),Xe=e=>(z("data-v-c9548632"),e=e(),O(),e),Qe=Xe(()=>a("span",{class:"block text-center mb-10"},"or",-1));function xe(e,t,n,p,S,w){const l=h("wizard-input"),E=h("wizard-form-footer"),I=h("stepper-item"),N=h("stepper"),D=h("panel-screen");return i(),v(D,{panel:e.panel},{header:g(()=>[M(u(e.$t("wizard.title")),1)]),content:g(()=>[m(N,{activeStep:e.step},{default:g(()=>[r(" Upload data wizard step "),m(I,{title:e.$t("wizard.upload.title"),summary:e.url},{default:g(()=>[a("form",{name:"upload",onSubmit:t[2]||(t[2]=(...o)=>e.onUploadContinue&&e.onUploadContinue(...o))},[r(" Upload a file "),m(l,{type:"file",name:"file",label:e.$t("wizard.upload.file.label"),help:e.$t("wizard.upload.file.help"),onUpload:e.updateFile},null,8,["label","help","onUpload"]),Qe,r(" Provide layer URL "),m(l,{type:"url",name:"url",modelValue:e.url,"onUpdate:modelValue":t[0]||(t[0]=o=>e.url=o),label:e.$t("wizard.upload.url.label"),onLink:e.updateUrl,validation:!0,"validation-messages":{required:e.$t("wizard.upload.url.error.required"),invalid:e.$t("wizard.upload.url.error.url")}},null,8,["modelValue","label","onLink","validation-messages"]),m(E,{onSubmit:e.onUploadContinue,onCancel:t[1]||(t[1]=()=>{e.goNext=!1,e.goToStep(0)}),disabled:!e.goNext},null,8,["onSubmit","disabled"])],32)]),_:1},8,["title","summary"]),r(" Select format wizard step "),m(I,{title:e.$t("wizard.format.title"),summary:e.typeSelection},{default:g(()=>[a("form",{name:"format",onSubmit:t[6]||(t[6]=(...o)=>e.onSelectContinue&&e.onSelectContinue(...o))},[r(" List of file/service types based on layer "),m(l,{type:"select",name:"type",modelValue:e.typeSelection,"onUpdate:modelValue":t[3]||(t[3]=o=>e.typeSelection=o),onSelect:e.updateTypeSelection,size:e.isFileLayer()?e.fileTypeOptions.length:e.serviceTypeOptions.length,label:e.isFileLayer()?e.$t("wizard.format.type.file"):e.$t("wizard.format.type.service"),options:e.isFileLayer()?e.fileTypeOptions:e.serviceTypeOptions,formatError:e.formatError,validation:!0,"validation-messages":{required:e.$t("wizard.format.type.error.required"),invalid:e.$t("wizard.format.type.error.invalid")},onKeydown:t[4]||(t[4]=C(()=>{},["stop"]))},null,8,["modelValue","onSelect","size","label","options","formatError","validation-messages"]),m(E,{onSubmit:e.onSelectContinue,onCancel:t[5]||(t[5]=()=>{e.formatError=!1,e.url?e.goNext=!0:e.goNext=!1,e.goToStep(0)}),disabled:!1},null,8,["onSubmit"])],32)]),_:1},8,["title","summary"]),r(" Configure layer wizard step "),m(I,{title:e.$t("wizard.configure.title")},{default:g(()=>[a("form",{name:"configure",onSubmit:t[15]||(t[15]=(...o)=>e.onConfigureContinue&&e.onConfigureContinue(...o))},[e.layerInfo.configOptions.includes("name")?(i(),v(l,{key:0,type:"text",name:"name",modelValue:e.layerInfo.config.name,"onUpdate:modelValue":t[7]||(t[7]=o=>e.layerInfo.config.name=o),onText:e.updateLayerName,label:e.$t("wizard.configure.name.label"),validation:!0,"validation-messages":{required:e.$t("wizard.configure.name.error.required")}},null,8,["modelValue","onText","label","validation-messages"])):r("v-if",!0),e.layerInfo.configOptions.includes("nameField")?(i(),v(l,{key:1,type:"select",name:"nameField",modelValue:e.layerInfo.config.nameField,"onUpdate:modelValue":t[8]||(t[8]=o=>e.layerInfo.config.nameField=o),label:e.$t("wizard.configure.nameField.label"),defaultOption:!0,options:e.fieldOptions()},null,8,["modelValue","label","options"])):r("v-if",!0),e.layerInfo.configOptions.includes("tooltipField")?(i(),v(l,{key:2,type:"select",name:"tooltipField",modelValue:e.layerInfo.config.tooltipField,"onUpdate:modelValue":t[9]||(t[9]=o=>e.layerInfo.config.tooltipField=o),label:e.$t("wizard.configure.tooltipField.label"),options:e.fieldOptions()},null,8,["modelValue","label","options"])):r("v-if",!0),e.layerInfo.configOptions.includes("latField")?(i(),v(l,{key:3,type:"select",name:"latField",modelValue:e.layerInfo.config.latField,"onUpdate:modelValue":t[10]||(t[10]=o=>e.layerInfo.config.latField=o),defaultOption:!0,label:e.$t("wizard.configure.latField.label"),options:e.fieldOptions()},null,8,["modelValue","label","options"])):r("v-if",!0),e.layerInfo.configOptions.includes("longField")?(i(),v(l,{key:4,type:"select",name:"longField",modelValue:e.layerInfo.config.longField,"onUpdate:modelValue":t[11]||(t[11]=o=>e.layerInfo.config.longField=o),defaultOption:!0,label:e.$t("wizard.configure.longField.label"),options:e.fieldOptions()},null,8,["modelValue","label","options"])):r("v-if",!0),r(" For map image layers "),e.layerInfo.configOptions.includes("layerEntries")?(i(),v(l,{key:5,type:"select",name:"layerEntries",modelValue:e.layerInfo.config.layerEntries,"onUpdate:modelValue":t[12]||(t[12]=o=>e.layerInfo.config.layerEntries=o),onSelect:e.updateLayerEntries,label:e.$t("wizard.configure.layerEntries.label"),help:e.$t("wizard.configure.layerEntries.help"),options:e.sublayerOptions(),multiple:!0,validation:!0,"validation-messages":{required:e.$t("wizard.configure.layerEntries.error.required")},onKeydown:t[13]||(t[13]=C(()=>{},["stop"]))},null,8,["modelValue","onSelect","label","help","options","validation-messages"])):r("v-if",!0),m(E,{onSubmit:e.onConfigureContinue,onCancel:t[14]||(t[14]=o=>e.goToStep(1)),disabled:!e.finishStep},null,8,["onSubmit","disabled"])],32)]),_:1},8,["title"])]),_:1},8,["activeStep"])]),_:1},8,["panel"])}var et=b(Ze,[["render",xe],["__scopeId","data-v-c9548632"],["__file","/home/runner/work/ramp4-pcar4/ramp4-pcar4/src/fixtures/wizard/screen.vue"]]),at=Object.freeze(Object.defineProperty({__proto__:null,default:et},Symbol.toStringTag,{value:"Module"}));export{et as W,at as s,lt as w};
