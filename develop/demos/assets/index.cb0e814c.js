import{et as y,eu as B,ev as $,ew as p,ex as l,ey as h,ez as I,eA as d,eB as M,eC as C,eD as T,eE as g,eF as u,eG as w,eH as S,eI as f,eJ as O,eK as z,eL as A,eM as E,eN as V,eO as x,eP as m,eQ as L,eR as P,eS as v}from"./main.36623018.js";const F=y({name:"MoreAppbarButtonV",props:{position:{type:String,default:"bottom-right"},tooltip:{type:[String,Boolean],default:!1},tooltipPlacement:{type:String,default:"bottom"}},data(){return{open:!1}},mounted(){window.addEventListener("click",t=>{t.target instanceof HTMLElement&&!this.$el.contains(t.target)&&(this.open=!1)},{capture:!0})}}),H=t=>(C("data-v-18020f26"),t=t(),T(),t),R={class:"relative inset-x-0 w-full h-48 text-center"},U=["content"],j=H(()=>d("svg",{class:"fill-current w-24 h-24 m-auto",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},[d("path",{d:"M0 0h24v24H0z",fill:"none"}),d("path",{d:"M6 10c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm12 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2zm-6 0c-1.1 0-2 .9-2 2s.9 2 2 2 2-.9 2-2-.9-2-2-2z"})],-1)),G=[j],q=["position"];function J(t,e,s,o,i,r){const n=$("focus-item"),c=$("tippy");return p(),l("div",R,[h((p(),l("button",{class:"text-gray-400 w-full h-full focus:outline-none hover:text-white",onClick:e[0]||(e[0]=b=>t.open=!t.open),content:t.$t("appbar.more")},G,8,U)),[[n],[c,{placement:"right"}]]),h(d("div",{onBlur:e[1]||(e[1]=b=>t.open=!1),position:t.position,id:"dropdown",class:"dropdown shadow-md border border-gray:200 absolute py-8 w-64 bg-white rounded text-center z-10"},[M(t.$slots,"default",{},void 0,!0)],40,q),[[I,t.open]])])}var K=B(F,[["render",J],["__scopeId","data-v-18020f26"],["__file","/home/runner/work/ramp4-pcar4/ramp4-pcar4/src/fixtures/appbar/more-button.vue"]]);const Q=y({name:"NotificationsAppbarButtonV",data(){return{number:g("notification/notificationNumber")}},methods:{onClick(){this.$iApi.panel.toggle("notifications-panel")}}}),W=t=>(C("data-v-2ccdb150"),t=t(),T(),t),X=W(()=>d("svg",{class:"fill-current w-24 h-24 mx-8 sm:mx-20",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24"},[d("path",{d:"M12 22c1.1 0 2-.9 2-2h-4c0 1.1.89 2 2 2zm6-6v-5c0-3.07-1.64-5.64-4.5-6.32V4c0-.83-.67-1.5-1.5-1.5s-1.5.67-1.5 1.5v.68C7.63 5.36 6 7.92 6 11v5l-2 2v1h16v-1l-2-2z"})],-1)),Y={key:0,class:"number absolute top-1 right-2 text-white w-18 rounded-full"};function Z(t,e,s,o,i,r){const n=u("appbar-button",!0);return p(),w(n,{onClickFunction:t.onClick,tooltip:t.$t("notifications.title"),class:"notification-button",id:""},{default:S(()=>[f(" https://fonts.google.com/icons?selected=Material%20Icons%3Anotifications "),X,t.number&&t.number>0?(p(),l("span",Y,O(t.number),1)):f("v-if",!0)]),_:1},8,["onClickFunction","tooltip"])}var tt=B(Q,[["render",Z],["__scopeId","data-v-2ccdb150"],["__file","/home/runner/work/ramp4-pcar4/ramp4-pcar4/src/components/notification-center/appbar-button.vue"]]);const et=y({name:"AppbarV",components:{"more-button":K,"notifications-appbar-button":tt,"about-ramp-dropdown":z},data(){return{items:g("appbar/visible"),temporaryItems:g("appbar/temporary"),overflow:!1}},updated(){this.$nextTick(()=>{const t=this.$refs.el;let e=[...t.childNodes],s=e[e.length-2].clientTop,o=document.getElementById("dropdown");for(let n=e.length-3;n>=0;n--){let c=e[n].clientTop+e[n].clientHeight;if(s&&o&&(c>=s||this.overflow&&c+48>=s))console.log(`[${n}]`,e[n].getBoundingClientRect()),e[n].classList.remove("hover:text-white","text-gray-400"),e[n].classList.add("text-black","hover:bg-gray-100"),t.removeChild(e[n]),o.appendChild(e[n]),this.overflow||(this.overflow=!0);else break}let i=document.getElementById("more"),r=t.clientTop+t.clientHeight;if(this.overflow&&s&&i&&o&&r!==0&&(r<=s-48||o.childElementCount==1)){for(;r<=s-48||o.childElementCount==1;){let n=o.firstElementChild;n&&(n.classList.remove("text-black","hover:bg-gray-100"),n.classList.add("text-gray-400","hover:text-white"),o.removeChild(n),t.insertBefore(n,i))}o.childElementCount==0&&(this.overflow=!1)}})},methods:{addComponentIdSuffix(t){return t.includes("-appbar-button")?t:`${t}-appbar-button`}}}),ot={class:"absolute top-0 left-0 bottom-28 flex flex-col items-stretch w-40 pointer-events-auto appbar bg-black-75 z-50 sm:w-64 sm:z-0 sm:bottom-38",ref:"el"};function nt(t,e,s,o,i,r){const n=u("divider"),c=u("more-button"),b=u("notifications-appbar-button"),D=u("about-ramp-dropdown"),N=$("focus-list");return h((p(),l("div",ot,[(p(!0),l(A,null,E(t.items,(a,k)=>(p(),w(x(t.addComponentIdSuffix(a.componentId)),{key:`${a}-${k}`,class:V(["appbar-item",{"h-48":a.id!=="divider"}]),options:a.options,id:a.id},null,8,["class","options","id"]))),128)),m(n,{class:"appbar-item"}),(p(!0),l(A,null,E(t.temporaryItems,a=>(p(),w(x(t.addComponentIdSuffix(a.componentId)),{key:`${a.id}-temp`,class:"appbar-item h-48",options:a.options,id:a.id},null,8,["options","id"]))),128)),h(m(c,{id:"more"},null,512),[[I,t.overflow]]),m(b,{class:"appbar-item bottom-48 h-48 sm:display-none"}),f(" TODO: disabled this button for now, revist this when we need it in the future "),f(' <nav-button id="nav"></nav-button> '),m(D,{class:"absolute bottom-0 h-40 sm:display-none w-full text-center",position:"right-start"})])),[[N]])}var st=B(et,[["render",nt],["__file","/home/runner/work/ramp4-pcar4/ramp4-pcar4/src/fixtures/appbar/appbar.vue"]]);class it{items={};order=[];temporary=[];tempButtonDict={}}class _{id;options;componentId;constructor(e){const s={options:{},...typeof e=="string"?{id:e}:e};({id:this.id,options:this.options}=s)}}const rt={visible(t){return t.order.map(e=>t.items[e]).filter(e=>e.componentId)}},at={addTempButton(t,e){const s=t.state.tempButtonDict[e];s&&!t.state.temporary.find(o=>o.id===s.id)&&t.commit("ADD_TEMP_BUTTON",s)},removeTempButton(t,e){const s=t.state.tempButtonDict[e];if(!s)return;const o=t.state.temporary.find(i=>i.id===s.id);o&&t.commit("REMOVE_TEMP_BUTTON",o)}},pt={ADD_TEMP_BUTTON(t,e){t.temporary.push(e)},REMOVE_TEMP_BUTTON(t,e){t.temporary.splice(t.temporary.indexOf(e),1)}};function ct(){const t=new it;return{namespaced:!0,state:t,getters:{...rt},actions:{...at},mutations:{...pt,...L.mutations(["items","order","temporary","tempButtonDict"])}}}class lt extends P{get config(){return super.config}_parseConfig(e){if(!e)return;const s=e.items.map(o=>new _(o));if(this.$vApp.$store.set("appbar/items",s.reduce((o,i)=>(o[i.id]=i,o),{})),this.$vApp.$store.set("appbar/order",s.map(o=>o.id)),e.temporaryButtons){const o=Object.fromEntries(e.temporaryButtons.map(i=>typeof i=="string"?[`${i}-panel`,new _(i)]:[i.panelId,new _(i.appbarItem)]));this.$vApp.$store.set("appbar/tempButtonDict",o)}this._validateItems()}_validateItems(){this.$vApp.$store.get("appbar/order").forEach(s=>{[`${s}-appbar-button`,s].some(o=>{this.$iApi.fixture.get(o)&&this.$vApp.$store.set(`appbar/items@${s}.componentId`,o)})});const e=this.$vApp.$store.get("appbar/tempButtonDict");Object.keys(e).forEach(s=>{const o=e[s].id;[`${o}-appbar-button`,o].some(i=>{const r=!!this.$iApi.fixture.get(i);return r&&this.$vApp.$store.set(`appbar/tempButtonDict@${s}.componentId`,i),r})||this.$vApp.$store.set(`appbar/tempButtonDict@${s}.componentId`,o)})}}var dt={en:{"appbar.navigation":"Navigation","appbar.more":"More","navigation.export":"Export","navigation.map.export":"Export Map"},fr:{"appbar.navigation":"Navigation","appbar.more":"Plus","navigation.export":"Exporter","navigation.map.export":"Exporter la Carte"}};class mt extends lt{initialized(){console.log(`[fixture] ${this.id} initialized`)}async added(){console.log(`[fixture] ${this.id} added`),this.$vApp.$store.registerModule("appbar",ct()),Object.entries(dt).forEach(n=>this.$vApp.$i18n.mergeLocaleMessage(...n));const{vNode:e,destroy:s,el:o}=this.mount(st,{app:this.$element}),i=this.$vApp.$el.getElementsByClassName("inner-shell")[0];i.insertBefore(o.childNodes[0],i.querySelector(".panel-stack")),this._parseConfig(this.config),this.$vApp.$watch(()=>this.config,n=>this._parseConfig(n));let r=[];r.push(this.$iApi.event.on(v.PANEL_OPENED,n=>{this.$vApp.$store.dispatch("appbar/addTempButton",n.id)})),r.push(this.$iApi.event.on(v.PANEL_CLOSED,n=>{this.$vApp.$store.dispatch("appbar/removeTempButton",n.id)})),r.push(this.$iApi.event.on(v.COMPONENT,this._validateItems.bind(this))),this.removed=()=>{this.$vApp.$store.unregisterModule("appbar"),r.forEach(n=>this.$iApi.event.off(n)),s()}}}export{mt as default};
