import{j0 as d,fw as m,fv as f,eT as y,jd as l}from"./main.839c5da4.js";import{C as u}from"./common-layer.7522fccd.js";class g extends u{constructor(e,r){super(e,r),this.dataFormat=d.ESRI_FEATURE,this.hovertips=!1}_graphics=[];makeEsriLayerConfig(e){return super.makeEsriLayerConfig(e)}getFeatureCount(){return this._graphics.length}getLocalGraphic(e){return this._graphics.find(r=>r.id===e)}notLoadedErr(){console.error("Attempted to manipulate the layer before it was loaded"),console.trace()}get graphics(){return this._graphics.slice()}async addGraphic(e){if(!this.esriLayer){this.noLayerErr();return}let r;e instanceof Array?r=e:r=[e];const a=r.filter(i=>this._graphics.findIndex(h=>h.id===i.id)===-1?(this._graphics.push(i),!0):(console.error(`Attempting to add graphic with id '${i.id}' that has already been added.`),!1)),o=this.$iApi.geo.map.getSR(),s=a.map(i=>this.$iApi.geo.proj.projectGeometry(o,i.geometry)),n=await Promise.all(s),t=a.map((i,p)=>{const h=new m(n[p],i.id,i.attributes);return h.style=i.style,this.$iApi.geo.geom.graphicRampToEsri(h)});this.esriLayer.addMany(t)}removeGraphic(e){if(!this.esriLayer){this.noLayerErr();return}if(typeof e>"u"){this.esriLayer.removeAll();return}let r;Array.isArray(e)?r=e:r=[e];const a=r.map(s=>typeof s=="string"?s:s.id),o=[];a.forEach(s=>{const n=this.esriLayer?.graphics.find(t=>t.id===s);if(n){o.push(n);const t=this._graphics.findIndex(i=>i.id===s);t&&this._graphics.splice(t,1)}}),this.esriLayer.removeMany(o)}}class A extends g{constructor(e,r){super(e,r),this.layerType=f.GRAPHIC}async initiate(){this.esriLayer=y(new l(this.makeEsriLayerConfig(this.origRampConfig))),await super.initiate()}makeEsriLayerConfig(e){return super.makeEsriLayerConfig(e)}onLoadActions(){const e=super.onLoadActions();return this.layerTree.name=this.name,e}}export{A as default};
