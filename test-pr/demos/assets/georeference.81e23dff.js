import{go as ar,gl as ir,gx as sr,e as m,d as A,i as lr,J as cr,aR as R,av as ur,gy as J,gz as fr,gA as gr,gB as H,gC as G,gD as pr,gE as yr,gF as w,gG as hr,gH as V,gI as mr,aW as Ar,r as z,gJ as Tr,gK as $r,gL as C,ag as dr,gM as P,gN as Er,gO as vr,gP as Fr,gQ as q,gR as W,gS as U,gT as Mr,gk as xr,c as h,gU as N,gV as K,gW as Rr,gX as wr,gY as Pr}from"./main.4c7c23d9.js";import{I as k,v as Nr,P as br,e as Q,a as X}from"./quat.ee2eb111.js";import{e as T,a as E,b as Lr,c as _r,f as $,o as Z}from"./vec33.c81e26ba.js";import{T as g,i as f}from"./BufferView.6e25b375.js";function v(r=Cr){return[r[0],r[1],r[2],r[3]]}function lt(r,t,e=v()){return ar(e,r),e[3]=t,e}function ct(r,t,e=v()){return k(F,r,S(r)),k(D,t,S(t)),Nr(F,D,F),Br(e,sr(br(e,F)))}function ut(r){return r}function S(r){return ir(r[3])}function Br(r,t){return r[3]=t,r}const Cr=[0,0,1,0],F=Q(),D=Q();v();var Y;let y=Y=class extends cr{constructor(r){super(r),this.origin=R(),this.translation=R(),this.rotation=v(),this.scale=ur(1,1,1),this.geographic=!0}get localMatrix(){const r=T();return J(r,r,this.scale),fr(r,r,S(this.rotation),this.rotation),gr(r,r,this.translation),r}get localMatrixInverse(){return H(T(),this.localMatrix)}applyLocal(r,t){return G(t,r,this.localMatrix)}applyLocalInverse(r,t){return G(t,r,this.localMatrixInverse)}project(r,t){const e=new Float64Array(r.length),o=g.fromTypedArray(e),n=g.fromTypedArray(r);if(this.geographic){const l=pr(yr(t)),c=T();return w(t,this.origin,c,l),hr(c,c,this.localMatrix),E(o,n,c),V(e,l,0,e,t,0,e.length/3),e}const{localMatrix:a,origin:i}=this;mr(a,Lr)?_r(o,n):E(o,n,a);for(let l=0;l<e.length;l+=3)e[l+0]+=i[0],e[l+1]+=i[1],e[l+2]+=i[2];return e}getOriginPoint(r){const[t,e,o]=this.origin;return new Ar({x:t,y:e,z:o,spatialReference:r})}equals(r){return z(r)&&this.geographic===r.geographic&&Tr(this.origin,r.origin)&&$r(this.localMatrix,r.localMatrix)}clone(){const r={origin:C(this.origin),translation:C(this.translation),rotation:v(this.rotation),scale:C(this.scale),geographic:this.geographic};return new Y(r)}};m([A({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"origin",void 0),m([A({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"translation",void 0),m([A({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"rotation",void 0),m([A({type:[Number],nonNullable:!0,json:{write:!0}})],y.prototype,"scale",void 0),m([A({type:Boolean,nonNullable:!0,json:{write:!0}})],y.prototype,"geographic",void 0),m([A()],y.prototype,"localMatrix",null),m([A()],y.prototype,"localMatrixInverse",null),y=Y=m([lr("esri.geometry.support.MeshTransform")],y);const zr=y;function b(r,t){var e;return r.isGeographic||r.isWebMercator&&((e=t?.geographic)==null||e)}const L=dr.getLogger("esri.geometry.support.meshUtils.normalProjection");function Sr(r,t,e,o,n){return B(o)?(_(0,f.fromTypedArray(r),g.fromTypedArray(t),g.fromTypedArray(e),o,f.fromTypedArray(n)),n):(L.error("Cannot convert spatial reference to PCPF"),n)}function Yr(r,t,e,o,n){return B(o)?(_(1,f.fromTypedArray(r),g.fromTypedArray(t),g.fromTypedArray(e),o,f.fromTypedArray(n)),n):(L.error("Cannot convert to spatial reference from PCPF"),n)}function jr(r,t,e){return V(r,t,0,e,P(t),0,r.length/3),e}function Ir(r,t,e){return V(r,P(e),0,t,e,0,r.length/3),t}function Vr(r,t,e){if(h(r))return t;const o=g.fromTypedArray(r),n=g.fromTypedArray(t);return E(n,o,e),t}function Or(r,t,e){if(h(r))return t;N(u,e);const o=f.fromTypedArray(r),n=f.fromTypedArray(t);return $(n,o,u),K(u)||Z(n,n),t}function Gr(r,t,e){if(h(r))return t;N(u,e);const o=f.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),n=f.fromTypedArray(t,4*Float32Array.BYTES_PER_ELEMENT);if($(n,o,u),K(u)||Z(n,n),r!==t)for(let a=3;a<r.length;a+=4)t[a]=r[a];return t}function qr(r,t,e,o,n){if(!B(o))return L.error("Cannot convert spatial reference to PCPF"),n;_(0,f.fromTypedArray(r,4*Float32Array.BYTES_PER_ELEMENT),g.fromTypedArray(t),g.fromTypedArray(e),o,f.fromTypedArray(n,4*Float32Array.BYTES_PER_ELEMENT));for(let a=3;a<r.length;a+=4)n[a]=r[a];return n}function Wr(r,t,e,o,n){if(!B(o))return L.error("Cannot convert to spatial reference from PCPF"),n;_(1,f.fromTypedArray(r,16),g.fromTypedArray(t),g.fromTypedArray(e),o,f.fromTypedArray(n,16));for(let a=3;a<r.length;a+=4)n[a]=r[a];return n}function _(r,t,e,o,n,a){if(!t)return;const i=e.count,l=P(n);if(rr(n))for(let c=0;c<i;c++)o.getVec(c,M),t.getVec(c,p),w(l,M,x,l),q(u,x),r===1&&W(u,u),U(p,p,u),a.setVec(c,p);else for(let c=0;c<i;c++){o.getVec(c,M),t.getVec(c,p),w(l,M,x,l),q(u,x);const d=Mr(e.get(c,1));let s=Math.cos(d);r===0&&(s=1/s),u[0]*=s,u[1]*=s,u[2]*=s,u[3]*=s,u[4]*=s,u[5]*=s,r===1&&W(u,u),U(p,p,u),xr(p,p),a.setVec(c,p)}return a}function B(r){return rr(r)||Ur(r)}function rr(r){return r.isWGS84||Er(r)||vr(r)||Fr(r)}function Ur(r){return r.isWebMercator}const M=R(),p=R(),x=T(),u=X();function tr(r,t,e){return b(t.spatialReference,e)?Hr(r,t,e):Jr(r,t,e)}function kr(r,t,e){const{position:o,normal:n,tangent:a}=r;if(h(t))return{position:o,normal:n,tangent:a};const i=t.localMatrix;return tr({position:Vr(o,new Float64Array(o.length),i),normal:z(n)?Or(n,new Float32Array(n.length),i):null,tangent:z(a)?Gr(a,new Float32Array(a.length),i):null},t.getOriginPoint(e),{geographic:t.geographic})}function ft(r,t,e){if(e!=null&&e.useTransform){var o;const{position:n,normal:a,tangent:i}=r;return{vertexAttributes:{position:n,normal:a,tangent:i},transform:new zr({origin:[t.x,t.y,(o=t.z)!=null?o:0],geographic:b(t.spatialReference,e)})}}return{vertexAttributes:tr(r,t,e),transform:null}}function Dr(r,t,e){return b(t.spatialReference,e)?er(r,t,e):j(r,t,e)}function gt(r,t,e,o){if(h(t))return Dr(r,e,o);const n=kr(r,t,e.spatialReference);return e.equals(t.getOriginPoint(e.spatialReference))?j(n,e,o):b(e.spatialReference,o)?er(n,e,o):j(n,e,o)}function Jr(r,t,e){const o=new Float64Array(r.position.length),n=r.position,a=t.x,i=t.y,l=t.z||0,{horizontal:c,vertical:d}=O(e?e.unit:null,t.spatialReference);for(let s=0;s<n.length;s+=3)o[s+0]=n[s+0]*c+a,o[s+1]=n[s+1]*c+i,o[s+2]=n[s+2]*d+l;return{position:o,normal:r.normal,tangent:r.tangent}}function Hr(r,t,e){const o=t.spatialReference,n=nr(t,e,I),a=new Float64Array(r.position.length),i=Kr(r.position,n,o,a),l=N(or,n);return{position:i,normal:Qr(i,a,r.normal,l,o),tangent:Xr(i,a,r.tangent,l,o)}}function Kr(r,t,e,o){E(g.fromTypedArray(o),g.fromTypedArray(r),t);const n=new Float64Array(r.length);return Ir(o,n,e)}function Qr(r,t,e,o,n){if(h(e))return null;const a=new Float32Array(e.length);return $(f.fromTypedArray(a),f.fromTypedArray(e),o),Yr(a,r,t,n,a),a}function Xr(r,t,e,o,n){if(h(e))return null;const a=new Float32Array(e.length);$(f.fromTypedArray(a,4*Float32Array.BYTES_PER_ELEMENT),f.fromTypedArray(e,4*Float32Array.BYTES_PER_ELEMENT),o);for(let i=3;i<a.length;i+=4)a[i]=e[i];return Wr(a,r,t,n,a),a}function j(r,t,e){const o=new Float64Array(r.position.length),n=r.position,a=t.x,i=t.y,l=t.z||0,{horizontal:c,vertical:d}=O(e?e.unit:null,t.spatialReference);for(let s=0;s<n.length;s+=3)o[s+0]=(n[s+0]-a)/c,o[s+1]=(n[s+1]-i)/c,o[s+2]=(n[s+2]-l)/d;return{position:o,normal:r.normal,tangent:r.tangent}}function er(r,t,e){const o=t.spatialReference;nr(t,e,I);const n=H(et,I),a=new Float64Array(r.position.length),i=Zr(r.position,o,n,a),l=N(or,n);return{position:i,normal:rt(r.normal,r.position,a,o,l),tangent:tt(r.tangent,r.position,a,o,l)}}function nr(r,t,e){w(r.spatialReference,[r.x,r.y,r.z||0],e,P(r.spatialReference));const{horizontal:o,vertical:n}=O(t?t.unit:null,r.spatialReference);return J(e,e,[o,o,n]),e}function Zr(r,t,e,o){const n=jr(r,t,o),a=g.fromTypedArray(n),i=new Float64Array(n.length),l=g.fromTypedArray(i);return E(l,a,e),i}function rt(r,t,e,o,n){if(h(r))return null;const a=Sr(r,t,e,o,new Float32Array(r.length)),i=f.fromTypedArray(a);return $(i,i,n),a}function tt(r,t,e,o,n){if(h(r))return null;const a=qr(r,t,e,o,new Float32Array(r.length)),i=f.fromTypedArray(a,4*Float32Array.BYTES_PER_ELEMENT);return $(i,i,n),a}function O(r,t){if(h(r))return nt;const e=t.isGeographic?1:Rr(t),o=t.isGeographic?1:wr(t),n=Pr(1,r,"meters");return{horizontal:n*e,vertical:n*o}}const I=T(),et=T(),or=X(),nt={horizontal:1,vertical:1};export{qr as B,Sr as F,Ir as M,zr as O,Wr as R,kr as _,Yr as a,ft as b,v as c,S as d,lt as e,gt as f,Dr as k,ut as l,ct as q,b as r,jr as v,tr as x};
